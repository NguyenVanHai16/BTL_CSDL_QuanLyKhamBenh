# Th√¥ng tin c√° nh√¢n
   - H·ªç v√† T√™n: Nguy·ªÖn VƒÉn H·∫£i
   - MSSV: K215480106073
   - L·ªõp: K57KMT
   - M√¥n h·ªçc: H·ªá qu·∫£n tr·ªã c∆° s·ªü d·ªØ li·ªáu

## ƒê·ªÄ T√ÄI: Qu·∫£n l√Ω kh√°m b·ªánh t·∫°i b·ªánh vi·ªán
- M√¥ t·∫£ b√†i to√°n qu·∫£n l√Ω: Qu·∫£n l√Ω th√¥ng tin b·ªánh nh√¢n, h·ªì s∆° b·ªánh √°n, v√† th√¥ng tin b√°c sƒ© t·∫°i b·ªánh vi·ªán, h·ªó tr·ª£ vi·ªác tra c·ª©u v√† b√°o c√°o th√¥ng tin, gi√∫p c·∫£i thi·ªán c√¥ng t√°c kh√°m ch·ªØa b·ªánh v√† theo d√µi t√¨nh tr·∫°ng s·ª©c kh·ªèe c·ªßa b·ªánh nh√¢n.

### Nh·ªØng ch·ª©c nƒÉng x√¢y d·ª±ng qu·∫£n l√Ω kh√°m b·ªánh
1. Qu·∫£n l√Ω

1.1. Qu·∫£n L√Ω B·ªánh nh√¢n

   - Th√™m danh s√°ch b·ªánh nh√¢n: Cho ph√©p th√™m m·ªõi m·ªôt b·ªánh nh√¢n m·ªõi v√†o c∆° s·ªü d·ªØ li·ªáu
   - Ch·ªânh s·ª≠a th√¥ng tin b·ªánh nh√¢n: Cho ph√©p ch·ªânh s·ª≠a th√¥ng tin c·ªßa m·ªôt b·ªánh nh√¢n ƒë√£ t·ªìn t·∫°i
   - X√≥a b·ªánh nh√¢n: Cho ph√©p x√≥a m·ªôt b·ªánh nh√¢n c≈© kh·ªèi c∆° s·ªü d·ªØ li·ªáu
   - T√¨m ki·∫øm b·ªánh nh√¢n: Cho ph√©p t√¨m ki·∫øm b·ªánh nh√¢n theo t√™n, ID, ...
   - Xem danh s√°ch b·ªánh nh√¢n: Hi·ªÉn th·ªã danh s√°ch t·∫•t c·∫£ c√°c b·ªánh nh√¢n trong b·ªánh vi·ªán

1.2. Qu·∫£n l√Ω b√°c sƒ©
   - Th√™m danh s√°ch b√°c sƒ©: Cho ph√©p th√™m m·ªõi m·ªôt b√°c sƒ© m·ªõi v√†o c∆° s·ªü d·ªØ li·ªáu
   - Ch·ªânh s·ª≠a th√¥ng tin b√°c sƒ©: Cho ph√©p ch·ªânh s·ª≠a th√¥ng tin c·ªßa m·ªôt b√°c sƒ© ƒë√£ t·ªìn t·∫°i
   - X√≥a b√°c sƒ©: Cho ph√©p x√≥a m·ªôt b√°c sƒ© c≈© kh·ªèi c∆° s·ªü d·ªØ li·ªáu
   - T√¨m ki·∫øm b√°c sƒ©: Cho ph√©p t√¨m ki·∫øm b√°c sƒ© theo t√™n, ID, ...
   - Xem danh s√°ch b√°c sƒ©: Hi·ªÉn th·ªã danh s√°ch t·∫•t c·∫£ c√°c b√°c sƒ© trong b·ªánh vi·ªán
     
2. Ch·ª©c nƒÉng truy v·∫•n
   - T√¨m ki·∫øm b·ªánh nh√¢n theo t√™n
   - T√¨m ki·∫øm b√°c sƒ© theo chuy√™n khoa
   - Hi·ªÉn th·ªã th√¥ng tin b·ªánh nh√¢n
   - Hi·ªÉn th·ªã th√¥ng tin b√°c sƒ©
   - Hi·ªÉn th·ªã th√¥ng tin ph√≤ng kh√°m
   - Hi·ªÉn th·ªã th√¥ng tin l·ªãch s·ª≠ kh√°m
   - Hi·ªÉn th·ªã th√¥ng tin l·ªãch h·∫πn
     
### C√°c th√¥ng tin li√™n quan ƒë·∫øn b·ªánh nh√¢n
1. Th√¥ng tin c√° nh√¢n
   - M√£ b·ªánh nh√¢n: m√£ ƒë·ªãnh danh duy nh·∫•t c·ªßa m·ªói b·ªánh nh√¢n
   -  H·ªç v√† t√™n: h·ªç v√† t√™n ƒë·∫ßy ƒë·ªß c·ªßa b·ªánh nh√¢n
   - Ng√†y sinh: ng√†y, th√°ng, nƒÉm sinh c·ªßa b·ªánh nh√¢n
   - Gi·ªõi t√≠nh: nam ho·∫∑c n·ªØ
   - ƒê·ªãa ch·ªâ: ƒë·ªãa ch·ªâ hi·ªán t·∫°i c·ªßa b·ªánh nh√¢n
   - S·ªë ƒëi·ªán tho·∫°i: s·ªë ƒëi·ªán tho·∫°i li√™n h·ªá c·ªßa b·ªánh nh√¢n
  
2. Th√¥ng tin y t·∫ø
   - M√£ b·ªánh
   - T√™n b·ªánh
   - M√¥ t·∫£ b·ªánh

3. L·ªãch s·ª≠ kh√°m ch·ªØa b·ªánh
   - M√£ l·ªãch s·ª≠
   - T√™n b·ªánh nh√¢n
   - Ng√†y kh√°m
   - Tri·ªáu ch·ª©ng
   - Chu·∫©n ƒëo√°n

4. Th√¥ng tin b√°c sƒ©
   - M√£ b√°c sƒ©: m√£ ƒë·ªãnh danh duy nh·∫•t c·ªßa m·ªói b√°c sƒ©
   - H·ªç v√† t√™n: h·ªç v√† t√™n ƒë·∫ßy ƒë·ªß c·ªßa b√°c sƒ©
   - Khoa: khoa m√† b√°c sƒ© l√†m vi·ªác
   - S·ªë ƒëi·ªán tho·∫°i

5. Th√¥ng tin ph√≤ng kh√°m
   - M√£ ph√≤ng
   - T√™n ph√≤ng
   - S·ªë l∆∞·ª£ng b·ªánh nh√¢n

## X√¢y d·ª±ng ch∆∞∆°ng tr√¨nh qu·∫£n l√Ω kh√°m b·ªánh t·∫°i b·ªánh vi·ªán trong SQL:

1. B·∫£ng b·ªánh nh√¢n
   - T·∫°o b·∫£ng BenhNhan
   - MaBenhNhanüîë: kh√≥a ch√≠nh ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ x√°c ƒë·ªãnh t·ª´ng b·ªánh nh√¢n m·ªôt c√°ch duy nh·∫•t, t·ª± ƒë·ªông tƒÉng l√™n.
   - HoTen: h·ªç v√£ t√™n c·ªßa b·ªánh nh√¢n
   - NgaySinh: ng√†y, th√°ng, nƒÉm sinh c·ªßa b·ªánh nh√¢n
   - GioiTinh: gi·ªõi t√≠nh c·ªßa b·ªánh nh√¢n
   - DiaChi: ƒë·ªãa ch·ªâ c·ªßa b·ªánh nh√¢n
   - SoDienThoai: th√¥ng tin li√™n l·∫°c c·ªßa b·ªánh nh√¢n

```
   CREATE TABLE BenhNhan (
       MaBenhNhan INT PRIMARY KEY IDENTITY(1,1),
       HoTen NVARCHAR(100),
       NgaySinh DATE,
       GioiTinh NVARCHAR(10),
       DiaChi NVARCHAR(200),
       SoDienThoai NVARCHAR(15)
   );
```
   - ![image](https://github.com/NguyenVanHai16/BTL_CSDL_QuanLyKhamBenh/assets/168853303/9dd63f49-a8bf-4c42-8bf1-10db5cbab248)

1. B·∫£ng B√°c sƒ©
   - T·∫°o b·∫£ng BacSi
   - MaBacSiüîë: kh√≥a ch√≠nh ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ x√°c ƒë·ªãnh t·ª´ng b√°c sƒ© m·ªôt c√°ch duy nh·∫•t, t·ª± ƒë·ªông tƒÉng l√™n.
   - HoTen: h·ªç v√† t√™n c·ªßa b√°c sƒ©
   - ChuyenKhoa: b√°c sƒ© chuy√™n v·ªÅ khoa...
   - SoDienThoai: th√¥ng tin li√™n l·∫°c c·ªßa b√°c sƒ©
  
```
   CREATE TABLE BacSi (
       MaBacSi INT PRIMARY KEY IDENTITY(1,1),
       HoTen NVARCHAR(100),
       ChuyenKhoa NVARCHAR(100),
       SoDienThoai NVARCHAR(15)
   );
```

   - ![image](https://github.com/hoadain/demo-git/assets/168853303/cdfddc6d-4988-4f2f-8233-3066555c4f58)

2. B·∫£ng ph√≤ng kh√°m
   - T·∫°o b·∫£ng PhongKham
   - MaPhongüîë: kh√≥a ch√≠nh
   - TenPhong: t√™n c·ªßa ph√≤ng kh√°m
   - SoLuongBenhNhan: s·ªë l∆∞·ª£ng b·ªánh nh√¢n trong ph√≤ng kh√°m

```
   CREATE TABLE PhongKham (
       MaPhong INT PRIMARY KEY IDENTITY(1,1),
       TenPhong NVARCHAR(100),
       SoLuongBenhNhan INT
   );
```

   - ![image](https://github.com/hoadain/demo-git/assets/168853303/4438bcd0-cf9d-455c-9a92-fabace60c956)

2. B·∫£ng l·ªãch s·ª≠ kh√°m
   - T·∫°o b·∫£ng LichSuKham
   - MaLichSuüîë: kh√≥a ch√≠nh
   - MaBenhNhan: m√£ c·ªßa b·ªánh nh√¢n
   - NgayKham: ng√†y b·ªánh nh√¢n ƒëi kh√°m
   - TrieuChung: tri·ªáu ch·ª©ng c·ªßa b·ªánh nh√¢n
   - ChanDoan: chu·∫©n ƒëo√°n b·ªánh nh√¢n m·∫Øc b·ªánh g√¨
   - MaBenhNhanüîë: kh√≥a ngo·∫°i (FOREIGN KEY) tham chi·∫øu MaBenhNhan c·ªßa b·∫£ng BenhNhan. ƒêi·ªÅu n√†y thi·∫øt l·∫≠p m·ªëi li√™n h·ªá gi·ªØa c√°c b·∫£ng v√† cho ph√©p truy c·∫≠p th√¥ng tin.

```
   CREATE TABLE LichSuKham (
       MaLichSu INT PRIMARY KEY IDENTITY(1,1),
       MaBenhNhan INT,
       NgayKham DATE,
       TrieuChung NVARCHAR(MAX),
       ChanDoan NVARCHAR(MAX),
       FOREIGN KEY (MaBenhNhan) REFERENCES BenhNhan(MaBenhNhan)
   );
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/b99b818e-91b5-4851-9361-dcd6a0ea612b)

2. B·∫£ng l·ªãch h·∫πn
   - T·∫°o b·∫£ng LichHen
   - MaLichHenüîë: kh√≥a ch√≠nh
   - MaBenhNhan: m√£ c·ªßa b·ªánh nh√¢n
   - MaBacSi: m√£ c·ªßa b√°c sƒ©
   - MaPhong: m√£ ph√≤ng
   - NgayHen: ng√†y h·∫πn kh√°m
   - GioHen: gi·ªù h·∫πn kh√°m
   - TrangThai: tr·∫°ng th√°i h·∫πn
   - MaBenhNhanüîë: kh√≥a ngo·∫°i (FOREIGN KEY) tham chi·∫øu MaBenhNhan c·ªßa b·∫£ng BenhNhan. ƒêi·ªÅu n√†y thi·∫øt l·∫≠p m·ªëi li√™n h·ªá gi·ªØa c√°c b·∫£ng v√† cho ph√©p truy c·∫≠p th√¥ng tin.
   - MaBacSiüîë: kh√≥a ngo·∫°i (FOREIGN KEY) tham chi·∫øu MaBacSi c·ªßa b·∫£ng BacSi. ƒêi·ªÅu n√†y thi·∫øt l·∫≠p m·ªëi li√™n h·ªá gi·ªØa c√°c b·∫£ng v√† cho ph√©p truy c·∫≠p th√¥ng tin.
   - MaPhongüîë: kh√≥a ngo·∫°i (FOREIGN KEY) tham chi·∫øu MaPhong c·ªßa b·∫£ng PhongKham. ƒêi·ªÅu n√†y thi·∫øt l·∫≠p m·ªëi li√™n h·ªá gi·ªØa c√°c b·∫£ng v√† cho ph√©p truy c·∫≠p th√¥ng tin.
```
   CREATE TABLE LichHen (
       MaLichHen INT PRIMARY KEY IDENTITY(1,1),
       MaBenhNhan INT,
       MaBacSi INT,
       MaPhong INT,
       NgayHen DATE,
       GioHen TIME,
       TrangThai NVARCHAR(20),
       FOREIGN KEY (MaBenhNhan) REFERENCES BenhNhan(MaBenhNhan),
       FOREIGN KEY (MaBacSi) REFERENCES BacSi(MaBacSi),
       FOREIGN KEY (MaPhong) REFERENCES PhongKham(MaPhong)
   );
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/db855978-32cb-40fa-abcf-25ec612dac86)
     
3. S∆° ƒë·ªì li√™n k·∫øt
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/144a9a00-808c-46e7-85ae-95f98a00aa4b)
     
## Th√™m d·ªØ li·ªáu v√†o b·∫£ng

- Add data v√†o b·∫£ng BenhNhan
```
  (N'Tran Thi A', '1982-03-03', N'Nu', N'486 Le Thanh Ton, Quan 3, TP HN','0911225436')
  (N'Nguyen Van B', '1982-07-04', N'Nam', N'653 Le Thanh , Quan 7, TP HN', '0911225763')
  (N'Nguyen van C', '1982-03-09', N'Nam', N'454 Thanh Ton, Quan 5, TP HN', '0911225123')
```
- Add data v√†o b·∫£ng BacSi
```
  (N'MR. Pham Hoa', zN'Tai mui hong', '0999888777')
  (N'Dr. Nguyen Van C', N'RƒÉng h√†m m·∫∑t', '0888777666')
```
- Add data v√†o b·∫£ng PhongKham
```
  (N'Phong kham 101')
  (N'Ph√≤ng kh√°m 102')
  (N'Ph√≤ng kh√°m 103')
```
- Add data v√†o b·∫£ng LichSuKham
```
   - (@MaBenhNhan'2024-06-19', N'ƒêau ƒë·∫ßu, s·ªët cao', N'C·∫£m c√∫m')
   - (@MaBenhNhan = 2, '2024-06-20', N'ƒêau b·ª•ng v√† bu·ªìn n√¥n', N'Vi√™m d·∫° d√†y')
```
- Add data v√†o b·∫£ng LichHen
```
   - (@MaBenhNhan, @MaBacSi, @MaPhong, 2024-06-21', '12:00:00')
   - (@MaBenhNhan , @MaBacSi, @MaPhong, '2024-06-22', '14:30:00')
```

## C√°c ch·ª©c nƒÉng 

- Qu·∫£n L√Ω b·ªánh nh√¢n
```
-- Th√™m b·ªánh nh√¢n (ThemBenhNhan)
CREATE PROCEDURE ThemBenhNhan (
    @HoTen NVARCHAR(100),
    @NgaySinh DATE,
    @GioiTinh NVARCHAR(10),
    @DiaChi NVARCHAR(200),
    @SoDienThoai NVARCHAR(15)
)
AS
BEGIN
    INSERT INTO BenhNhan (HoTen, NgaySinh, GioiTinh, DiaChi, SoDienThoai)
    VALUES (@HoTen, @NgaySinh, @GioiTinh, @DiaChi, @SoDienThoai);
END

--S·ª≠a ƒë·ªïi th√¥ng tin b·ªánh nh√¢n (SuaThongTinBenhNhan)
CREATE PROCEDURE SuaThongTinBenhNhan (
    @MaBenhNhan INT,
    @HoTen NVARCHAR(100),
    @NgaySinh DATE,
    @GioiTinh NVARCHAR(10),
    @DiaChi NVARCHAR(200),
    @SoDienThoai NVARCHAR(15)
)
AS
BEGIN
    UPDATE BenhNhan
    SET HoTen = @HoTen,
        NgaySinh = @NgaySinh,
        GioiTinh = @GioiTinh,
        DiaChi = @DiaChi,
        SoDienThoai = @SoDienThoai
    WHERE MaBenhNhan = @MaBenhNhan;
END

--X√≥a b·ªánh nh√¢n (XoaBenhNhan)
CREATE PROCEDURE XoaBenhNhan (
    @MaBenhNhan INT
)
AS
BEGIN
    DELETE FROM BenhNhan
    WHERE MaBenhNhan = @MaBenhNhan;
END
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/5536873d-230a-413a-b70b-3173a414c74e)
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/2ae7a1c2-22ba-4012-a752-41e205ed796c)
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/09843e0a-0e9e-4c6e-acc9-dac48b316497)

- Qu·∫£n l√Ω b√°c sƒ©
```
--Th√™m b√°c sƒ© (ThemBacSi)
CREATE PROCEDURE ThemBacSi (
    @HoTen NVARCHAR(100),
    @ChuyenKhoa NVARCHAR(100),
    @SoDienThoai NVARCHAR(15)
)
AS
BEGIN
    INSERT INTO BacSi (HoTen, ChuyenKhoa, SoDienThoai)
    VALUES (@HoTen, @ChuyenKhoa, @SoDienThoai);
END

--S·ª≠a ƒë·ªïi th√¥ng tin b√°c sƒ© (SuaThongTinBacSi)
CREATE PROCEDURE SuaThongTinBacSi (
    @MaBacSi INT,
    @HoTen NVARCHAR(100),
    @ChuyenKhoa NVARCHAR(100),
    @SoDienThoai NVARCHAR(15)
)
AS
BEGIN
    UPDATE BacSi
    SET HoTen = @HoTen,
        ChuyenKhoa = @ChuyenKhoa,
        SoDienThoai = @SoDienThoai
    WHERE MaBacSi = @MaBacSi;
END

--X√≥a b√°c sƒ© (XoaBacSi)
CREATE PROCEDURE XoaBacSi (
    @MaBacSi INT
)
AS
BEGIN
    DELETE FROM BacSi
    WHERE MaBacSi = @MaBacSi;
END
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/401dbaf0-40ca-4dac-85a3-744634201a9e)
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/7b2b56ff-1ad8-4422-8d5e-e2d9d7628332)
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/272c036e-6fc0-445b-92d2-bb2609e85d96)

- Qu·∫£n l√Ω ph√≤ng kh√°m
```
--Th√™m ph√≤ng kh√°m (ThemPhongKham)
CREATE PROCEDURE ThemPhongKham (
    @TenPhong NVARCHAR(100)
)
AS
BEGIN
    INSERT INTO PhongKham (TenPhong, SoLuongBenhNhan)
    VALUES (@TenPhong, 0); -- M·∫∑c ƒë·ªãnh s·ªë l∆∞·ª£ng b·ªánh nh√¢n ban ƒë·∫ßu l√† 0
END

--S·ª≠a ƒë·ªïi th√¥ng tin ph√≤ng kh√°m (SuaThongTinPhongKham)
CREATE PROCEDURE SuaThongTinPhongKham (
    @MaPhong INT,
    @TenPhong NVARCHAR(100)
)
AS
BEGIN
    UPDATE PhongKham
    SET TenPhong = @TenPhong
    WHERE MaPhong = @MaPhong;
END

--X√≥a ph√≤ng kh√°m (XoaPhongKham)
CREATE PROCEDURE XoaPhongKham (
    @MaPhong INT
)
AS
BEGIN
    DELETE FROM PhongKham
    WHERE MaPhong = @MaPhong;
END
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/6f978bf0-1762-40b8-9355-783570dd61e6)
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/96bb89c1-0ebb-4354-9c12-049c0527956e)
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/78db82e5-0377-4864-a7cc-51e3a339af0d)

- Qu·∫£n l√Ω l·ªãch s·ª≠ kh√°m b·ªánh
```
--Th√™m l·ªãch s·ª≠ kh√°m (ThemLichSuKham)
CREATE PROCEDURE ThemLichSuKham (
    @MaBenhNhan INT,
    @NgayKham DATE,
    @TrieuChung NVARCHAR(MAX),
    @ChanDoan NVARCHAR(MAX)
)
AS
BEGIN
    INSERT INTO LichSuKham (MaBenhNhan, NgayKham, TrieuChung, ChanDoan)
    VALUES (@MaBenhNhan, @NgayKham, @TrieuChung, @ChanDoan);
END
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/1c49de35-b5b6-4f75-a1c2-84d84a1ad716)

- Qu·∫£n l√Ω l·ªãch h·∫πn kh√°m b·ªánh
```
--Th√™m l·ªãch h·∫πn (ThemLichHen)
CREATE PROCEDURE ThemLichHen (
    @MaBenhNhan INT,
    @MaBacSi INT,
    @MaPhong INT,
    @NgayHen DATE,
    @GioHen TIME
)
AS
BEGIN
    INSERT INTO LichHen (MaBenhNhan, MaBacSi, MaPhong, NgayHen, GioHen, TrangThai)
    VALUES (@MaBenhNhan, @MaBacSi, @MaPhong, @NgayHen, @GioHen, 'Chua kham');
    
    UPDATE PhongKham
    SET SoLuongBenhNhan = SoLuongBenhNhan + 1
    WHERE MaPhong = @MaPhong;
END
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/3287457a-8b50-4798-b57b-33df711210de)

## Ch·ª©c nƒÉng n√¢ng cao

1. S·ª≠ d·ª•ng Trigger
   - T·ª± ƒë·ªông c·∫≠p nh·∫≠t l·∫°i s·ªë l∆∞·ª£ng b·ªánh nh√¢n trong ph√≤ng kh√°m khi x√≥a l·ªãch h·∫πn
```
-- X√≥a trigger c≈© n·∫øu t·ªìn t·∫°i
IF OBJECT_ID('XoaLichHen', 'TR') IS NOT NULL
    DROP TRIGGER XoaLichHen;
GO

--trigger XoaLichHen
CREATE TRIGGER XoaLichHen
ON LichHen
AFTER DELETE
AS
BEGIN
    DECLARE @MaPhong INT;
    
    SELECT @MaPhong = MaPhong FROM DELETED;
    
    UPDATE PhongKham
    SET SoLuongBenhNhan = SoLuongBenhNhan - 1
    WHERE MaPhong = @MaPhong;
END
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/db956013-dfc8-4557-942d-2f2529c790a3)

2. S·ª≠ d·ª•ng cursor
   - g·ª≠i th√¥ng b√°o nh·∫Øc nh·ªü b·ªánh nh√¢n khi t·ªõi ng√†y h·∫πn kh√°m b·ªánh
```
--Cursor g·ª≠i th√¥ng b√°o nh·∫Øc nh·ªü (GuiThongBaoNhacNho)
CREATE PROCEDURE GuiThongBaoNhacNho
AS
BEGIN
    DECLARE @benhnhan NVARCHAR(100);
    DECLARE @ngayhen DATE;

    DECLARE cur CURSOR FOR 
        SELECT b.HoTen, l.NgayHen
        FROM BenhNhan b
        JOIN LichHen l ON b.MaBenhNhan = l.MaBenhNhan
        WHERE l.TrangThai = 'Chua kham' AND l.NgayHen = CAST(GETDATE() AS DATE);

    OPEN cur;
    FETCH NEXT FROM cur INTO @benhnhan, @ngayhen;

    WHILE @@FETCH_STATUS = 0
    BEGIN
        -- G·ª≠i th√¥ng b√°o nh·∫Øc nh·ªü (·ªü ƒë√¢y ch·ªâ l√† v√≠ d·ª•, c·∫ßn t√≠ch h·ª£p h·ªá th·ªëng g·ª≠i tin nh·∫Øn th·ª±c t·∫ø)
        PRINT CONCAT('Nh·∫Øc nh·ªü: B·ªánh nh√¢n ', @benhnhan, ' c√≥ l·ªãch h·∫πn v√†o ng√†y ', @ngayhen);
        
        FETCH NEXT FROM cur INTO @benhnhan, @ngayhen;
    END;

    CLOSE cur;
    DEALLOCATE cur;
END
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/5886389d-4934-40bc-ba8f-258c479f5cf4)

## T√¨m ki·∫øm v√† hi·ªÉn th·ªã th√¥ng tin

   - Hi·ªÉn th·ªã view b·ªánh nh√¢n
```
--View hi·ªÉn th·ªã th√¥ng tin c√°c b·ªánh nh√¢n (View_BenhNhan)
CREATE VIEW View_BenhNhan AS
SELECT 
    MaBenhNhan,
    HoTen,
    NgaySinh,
    GioiTinh,
    DiaChi,
    SoDienThoai
FROM 
    BenhNhan;
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/9812c452-873a-4ad6-a22b-ff81f7b36ce5)
   - K·∫øt qu·∫£
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/d2cac214-5dd5-44b9-81dc-757f1b332619)
     
   - Hi·ªÉn th·ªã view b√°c sƒ©
```
--View hi·ªÉn th·ªã th√¥ng tin c√°c b√°c sƒ© (View_BacSi)
CREATE VIEW View_BacSi AS
SELECT 
    MaBacSi,
    HoTen,
    ChuyenKhoa,
    SoDienThoai
FROM 
    BacSi;
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/988fdd23-0a7e-42ba-b74c-345063144dcc)
   - K·∫øt qu·∫£
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/439b59da-622c-4817-9ae1-ca549a029da6)
     
   - Hi·ªÉn th·ªã view ph√≤ng kh√°m
```
--View hi·ªÉn th·ªã th√¥ng tin c√°c ph√≤ng kh√°m (View_PhongKham)
CREATE VIEW View_PhongKham AS
SELECT 
    MaPhong,
    TenPhong,
    SoLuongBenhNhan
FROM 
    PhongKham;
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/584a9fa9-9c0c-406d-b186-0f2bd47d3775)
   - K·∫øt qu·∫£
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/e2113389-0de5-482f-a5b9-b7e09926a73a)

   - Hi·ªÉn th·ªã view l·ªãch s·ª≠ kh√°m b·ªánh
```
--Hi·ªÉn th·ªã th√¥ng tin l·ªãch s·ª≠ kh√°m trong View (View_LichSuKham)
	CREATE VIEW View_LichSuKham AS
SELECT 
    ls.MaLichSu,
    bn.HoTen AS TenBenhNhan,
    ls.NgayKham,
    ls.TrieuChung,
    ls.ChanDoan
FROM 
    LichSuKham ls
JOIN 
    BenhNhan bn ON ls.MaBenhNhan = bn.MaBenhNhan;
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/6fbd414a-384d-493c-b2ab-9e5e5bd5c703)
   - K·∫øt qu·∫£
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/d985744c-f811-478d-b102-5df389e9e94d)
     
   - Hi·ªÉn th·ªã view l·ªãch h·∫πn
```
--View hi·ªÉn th·ªã th√¥ng tin c√°c l·ªãch h·∫πn (View_LichHen)
CREATE VIEW View_LichHen AS
SELECT 
    lh.MaLichHen,
    bn.HoTen AS TenBenhNhan,
    bs.HoTen AS TenBacSi,
    pk.TenPhong,
    lh.NgayHen,
    lh.GioHen,
    lh.TrangThai
FROM 
    LichHen lh
JOIN 
    BenhNhan bn ON lh.MaBenhNhan = bn.MaBenhNhan
JOIN 
    BacSi bs ON lh.MaBacSi = bs.MaBacSi
JOIN 
    PhongKham pk ON lh.MaPhong = pk.MaPhong;
```
   - ![image](https://github.com/hoadain/demo-git/assets/168853303/b736ea5c-0fa1-4505-b6c6-1013b25a1ea0)
   - K·∫øt qu·∫£
   - ![image](https://github.com/NguyenVanHai16/BTL_CSDL_QuanLyKhamBenh/assets/168853303/b8d0a776-f736-4abe-84a3-abac8855818c)


